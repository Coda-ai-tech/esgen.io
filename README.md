# ESGEN - AI ESGå ±å‘Šç”Ÿæˆå™¨

ESGENæ˜¯ç‚ºé¦™æ¸¯ä¼æ¥­æ‰“é€ çš„ESGç”Ÿæ…‹ç³»çµ±ï¼Œè®“å…¬å¸èƒ½å¤ åœ¨30åˆ†é˜å…§ä»¥æ¥µä½æˆæœ¬ç”ŸæˆAIè¼”åŠ©çš„ESGå ±å‘Šï¼Œç„¶å¾Œäº¤ç”±å°ˆæ¥­ESGé¡§å•é©—è­‰å’Œæ”¹é€²è¦åŠƒã€‚

## é …ç›®æ¦‚è¿°

- **ä½¿å‘½**: æ¨™æº–åŒ–ä¸¦é™ä½ESGå ±å‘Šæˆæœ¬å’Œæ™‚é–“
- **å•†æ¥­æ¨¡å¼**: å…è²»é è¦½å ±å‘Š â†’ ä»˜è²»å®Œæ•´å ±å‘Šä¸‹è¼‰
- **æµç¨‹**: ç”¨æˆ¶è¨»å†Š â†’ è¡¨å–®å¡«å¯« â†’ AIé è¦½ â†’ ä»˜è²» â†’ å®Œæ•´PDFå ±å‘Š
- **æ•ˆç›Š**: ç¬¦åˆæ­ç›Ÿå¼æŠ«éœ²è¦æ±‚ã€å¼·åŒ–å“ç‰Œã€ç¶ è‰²è²¸æ¬¾å°±ç·’

## æ ¸å¿ƒæ¥­å‹™æµç¨‹

1. **ç”¨æˆ¶è¨»å†Š/ç™»å…¥**: å¿…é ˆè¨»å†Šä»¥å¯¦ç¾æ”¶è²»åŠŸèƒ½
2. **æ•¸æ“šæ”¶é›†**: 4æ­¥é©Ÿå¼•å°å¼è¡¨å–® (å…¬å¸è³‡æ–™ã€æ¡†æ¶ã€è­°é¡Œã€æ’æ”¾æ•¸æ“š)
3. **AIé è¦½ç”Ÿæˆ**: OpenAIç”Ÿæˆå…è²»é è¦½å ±å‘Š (æœ‰é™å…§å®¹)
4. **ä»˜è²»å‡ç´š**: Airwallexæ”¯ä»˜å®Œæ•´å ±å‘Šè²»ç”¨
5. **å®Œæ•´å ±å‘Š**: ç”Ÿæˆå°ˆæ¥­PDF + é›»éƒµç™¼é€ + å¹³å°ä¸‹è¼‰
6. **æ•¸æ“šå­˜å„²**: æ‰€æœ‰å ±å‘Šå’Œç”¨æˆ¶æ•¸æ“šå­˜å„²æ–¼Supabase

## æŠ€è¡“æ¶æ§‹

### å‰ç«¯ (Netlify)
- **æ¡†æ¶**: Next.js 15 (App Router), React 19, TypeScript
- **æ¨£å¼**: Tailwind CSS 4
- **éƒ¨ç½²**: Netlify (éœæ…‹ç«™é»å„ªåŒ–)

### å¾Œç«¯ (Render)
- **CMS**: Keystone.js (ç«¯å£ 3001)
- **API**: Node.js + Express
- **èªè­‰**: Keystone å…§å»ºèªè­‰ç³»çµ±

### æ•¸æ“šèˆ‡æœå‹™
- **æ•¸æ“šåº«**: Supabase (PostgreSQL)
- **æ–‡ä»¶å­˜å„²**: Supabase Storage
- **AIå¼•æ“**: OpenAI API (å ±å‘Šç”Ÿæˆ)
- **æ”¯ä»˜**: Airwallex API
- **é›»éƒµ**: å¾…å®š (SendGrid/AWS SES)
- **PDFç”Ÿæˆ**: Puppeteer / jsPDF

### éƒ¨ç½²æ¶æ§‹
```
ç”¨æˆ¶ â†’ Netlify (esgen.io) â†’ Render API (api.esgen.io:3001) â†’ Supabase
                                     â†“
                              OpenAI/Airwallex APIs
```

## é–‹ç™¼è¨­ç½®

### å¿«é€Ÿå•Ÿå‹• (åœ˜éšŠé–‹ç™¼)

```bash
# 1. å…‹éš†å€‰åº«
git clone https://github.com/Coda-ai-tech/esgen.io.git
cd esgen.io

# 2. å‰ç«¯è¨­ç½®
cd esgen-fresh
npm install
# é…ç½® .env.local (Supabase å¯†é‘°å·²è¨­ç½®)
npm run dev
# â†’ http://localhost:3000

# 3. å¾Œç«¯è¨­ç½® (æ–°çµ‚ç«¯çª—å£)
cd ../esgen-backend  
npm install
# é…ç½® .env (éœ€è¦æ›¿æ› YOUR_DB_PASSWORD)
npm run dev
# â†’ http://localhost:3001 (Keystone CMS)
```

### ç’°å¢ƒè¦æ±‚
- Node.js 18+
- npm æˆ– yarn
- Supabase å¸³æˆ¶ (å·²é…ç½®)
- ç¶²çµ¡é€£æ¥ (AI API èª¿ç”¨)

### é–‹ç™¼æŒ‡ä»¤

```bash
# å‰ç«¯é–‹ç™¼
npm run dev          # å•Ÿå‹•é–‹ç™¼æœå‹™å™¨
npm run build        # å»ºæ§‹ç”Ÿç”¢ç‰ˆæœ¬
npm run lint         # ä»£ç¢¼æª¢æŸ¥

# å¾Œç«¯é–‹ç™¼  
npm run dev          # å•Ÿå‹• Keystone CMS
npm run build        # å»ºæ§‹å¾Œç«¯
```

## ç’°å¢ƒè®Šé‡

### å‰ç«¯ (.env.local)
```env
# ç«™é»é…ç½®
NEXT_PUBLIC_SITE_URL=http://localhost:3000
NEXT_PUBLIC_API_URL=http://localhost:3001

# ç”Ÿç”¢ç’°å¢ƒ
# NEXT_PUBLIC_SITE_URL=https://esgen.io
# NEXT_PUBLIC_API_URL=https://api.esgen.io

# Supabase (å…¬é–‹å¯†é‘°)
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
```

### å¾Œç«¯ (.env)
```env
# Supabase é€£æ¥
DATABASE_URL=postgresql://[user]:[pass]@[host]:[port]/[db]
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key

# OpenAI
OPENAI_API_KEY=your_openai_api_key

# Airwallex
AIRWALLEX_API_KEY=your_airwallex_api_key
AIRWALLEX_CLIENT_ID=your_airwallex_client_id

# é›»éƒµæœå‹™
EMAIL_API_KEY=your_email_service_key

# Keystone
SESSION_SECRET=your_session_secret
```

## é …ç›®çµæ§‹ (Monorepo)

### å‰ç«¯ (æ ¹ç›®éŒ„)
```
src/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ page.tsx              # ä¸»é  (Traditional Chinese)
â”‚   â”œâ”€â”€ about/page.tsx        # é—œæ–¼é é¢
â”‚   â”œâ”€â”€ generate/page.tsx     # å ±å‘Šç”Ÿæˆè¡¨å–®
â”‚   â”œâ”€â”€ preview/page.tsx      # å ±å‘Šé è¦½é é¢ (å¾…é–‹ç™¼)
â”‚   â”œâ”€â”€ auth/                 # ç™»å…¥/è¨»å†Šé é¢ âœ…
â”‚   â”œâ”€â”€ dashboard/            # ç”¨æˆ¶å„€è¡¨æ¿ âœ…
â”‚   â””â”€â”€ layout.tsx            # æ ¹å¸ƒå±€
â”œâ”€â”€ components/               # å¯é‡ç”¨çµ„ä»¶
â”‚   â”œâ”€â”€ ui/                   # åŸºç¤UIçµ„ä»¶ âœ…
â”‚   â”œâ”€â”€ forms/                # è¡¨å–®çµ„ä»¶
â”‚   â””â”€â”€ reports/              # å ±å‘Šç›¸é—œçµ„ä»¶
â”œâ”€â”€ lib/                      # å·¥å…·å‡½æ•¸
â”‚   â”œâ”€â”€ supabase.ts           # Supabaseå®¢æˆ¶ç«¯ âœ…
â”‚   â”œâ”€â”€ openai.ts             # OpenAIé›†æˆ (å¾…é–‹ç™¼)
â”‚   â””â”€â”€ airwallex.ts          # æ”¯ä»˜é›†æˆ (å¾…é–‹ç™¼)
â”œâ”€â”€ contexts/
â”‚   â””â”€â”€ AuthContext.tsx       # èªè­‰ä¸Šä¸‹æ–‡ âœ…
â””â”€â”€ types/
    â””â”€â”€ database.ts           # TypeScripté¡å‹å®šç¾© âœ…
```

### å¾Œç«¯ (backend/)
```
backend/
â”œâ”€â”€ keystone.ts               # Keystoneé…ç½® âœ…
â”œâ”€â”€ schema.ts                 # æ•¸æ“šæ¨¡å‹ (User/Report/Payment) âœ…
â”œâ”€â”€ auth.ts                   # èªè­‰é…ç½® âœ…
â”œâ”€â”€ package.json              # ä¾è³´å’Œè…³æœ¬ âœ…
â”œâ”€â”€ .env                      # ç’°å¢ƒè®Šé‡ âœ…
â””â”€â”€ tsconfig.json             # TypeScripté…ç½® âœ…
```

### éƒ¨ç½²é…ç½®
- **å‰ç«¯**: Netlify â†’ `esgenio.netlify.app` âœ…
- **å¾Œç«¯**: Render â†’ (ä½¿ç”¨ `backend/` ç›®éŒ„ä½œç‚ºæ ¹è·¯å¾‘)

## é–‹ç™¼é‡Œç¨‹ç¢‘èˆ‡è¡Œå‹•é …ç›®

### ğŸš€ Phase 1: åŸºç¤è¨­æ–½ (ç¬¬1-2é€±)
**ç›®æ¨™**: å»ºç«‹å®Œæ•´çš„å‰å¾Œç«¯æ¶æ§‹

#### Backend Infrastructure
- [ ] **Supabaseé …ç›®å‰µå»º**
  - å‰µå»ºæ•¸æ“šåº«å¯¦ä¾‹
  - é…ç½®èªè­‰å’Œè¡Œç´šå®‰å…¨ (RLS)
  - è¨­ç½®å­˜å„²æ¡¶ (PDFæ–‡ä»¶)

- [ ] **Keystone.jså¾Œç«¯æ­å»º**
  - åˆå§‹åŒ–Keystoneé …ç›®
  - é…ç½®æ•¸æ“šåº«é€£æ¥
  - è¨­ç½®åŸºæœ¬èªè­‰ç³»çµ±

- [ ] **æ•¸æ“šæ¨¡å‹è¨­è¨ˆ**
  - Useræ¨¡å‹ (ç”¨æˆ¶è³‡æ–™ã€è¨‚é–±ç‹€æ…‹)
  - Reportæ¨¡å‹ (è¡¨å–®æ•¸æ“šã€AIç”Ÿæˆå…§å®¹ã€ç‹€æ…‹)
  - Paymentæ¨¡å‹ (äº¤æ˜“è¨˜éŒ„ã€ç‹€æ…‹è¿½è¹¤)

#### Frontend Integration
- [ ] **Supabaseå®¢æˆ¶ç«¯é›†æˆ**
  - å®‰è£å’Œé…ç½®Supabase SDK
  - è¨­ç½®èªè­‰æä¾›è€…
  - é€£æ¥APIç«¯é»

- [ ] **èªè­‰ç³»çµ±**
  - ç™»å…¥/è¨»å†Šé é¢
  - å—ä¿è­·è·¯ç”±
  - ç”¨æˆ¶ç‹€æ…‹ç®¡ç†

### ğŸ¤– Phase 2: AI å ±å‘Šç”Ÿæˆ (ç¬¬3-4é€±)
**ç›®æ¨™**: å¯¦ç¾æ ¸å¿ƒAIåŠŸèƒ½å’Œé è¦½ç³»çµ±

- [ ] **OpenAIé›†æˆ**
  - é…ç½®APIé€£æ¥
  - è¨­è¨ˆå ±å‘Šç”Ÿæˆæç¤ºè©
  - å¯¦ç¾é è¦½/å®Œæ•´å ±å‘Šå·®ç•°åŒ–

- [ ] **å ±å‘Šç”Ÿæˆæµç¨‹**
  - è¡¨å–®æ•¸æ“šè½‰æ›ç‚ºAIæç¤º
  - ç•°æ­¥å ±å‘Šç”Ÿæˆ
  - é€²åº¦ç‹€æ…‹æ›´æ–°

- [ ] **PDFç”Ÿæˆç³»çµ±**
  - é¸æ“‡PDFåº« (Puppeteer/jsPDF)
  - è¨­è¨ˆå°ˆæ¥­å ±å‘Šæ¨¡æ¿
  - å¯¦ç¾å‹•æ…‹å…§å®¹å¡«å……

- [ ] **é è¦½é é¢é–‹ç™¼**
  - å ±å‘Šé è¦½ç•Œé¢
  - ä»˜è²»å‡ç´šæç¤º
  - ä¸‹è¼‰/åˆ†äº«åŠŸèƒ½

### ğŸ’³ Phase 3: æ”¯ä»˜å’Œäº¤ä»˜ (ç¬¬5-6é€±)
**ç›®æ¨™**: å®Œæ•´å•†æ¥­åŒ–åŠŸèƒ½

- [ ] **Airwallexæ”¯ä»˜é›†æˆ**
  - APIé…ç½®å’Œæ¸¬è©¦
  - æ”¯ä»˜æµç¨‹è¨­è¨ˆ
  - æˆåŠŸ/å¤±æ•—å›èª¿è™•ç†

- [ ] **é›»éƒµç³»çµ±**
  - é¸æ“‡é›»éƒµæœå‹™ (SendGrid/AWS SES)
  - è¨­è¨ˆé›»éƒµæ¨¡æ¿
  - è‡ªå‹•ç™¼é€å®Œæ•´å ±å‘Š

- [ ] **ç”¨æˆ¶å„€è¡¨æ¿**
  - å ±å‘Šæ­·å²æŸ¥çœ‹
  - ä¸‹è¼‰ç®¡ç†
  - è³¬æˆ¶è¨­ç½®

### ğŸš€ Phase 4: éƒ¨ç½²å’Œå„ªåŒ– (ç¬¬7-8é€±)
**ç›®æ¨™**: ç”Ÿç”¢ç’°å¢ƒéƒ¨ç½²å’Œæ€§èƒ½å„ªåŒ–

- [ ] **ç”Ÿç”¢éƒ¨ç½²**
  - Netlifyå‰ç«¯éƒ¨ç½²
  - Renderå¾Œç«¯éƒ¨ç½²
  - åŸŸåé…ç½® (esgen.io)

- [ ] **æ€§èƒ½å„ªåŒ–**
  - åœ–ç‰‡å’Œè³‡æºå„ªåŒ–
  - APIéŸ¿æ‡‰æ™‚é–“å„ªåŒ–
  - SEOå„ªåŒ–

- [ ] **ç›£æ§å’Œåˆ†æ**
  - éŒ¯èª¤è¿½è¹¤ (Sentry)
  - ç”¨æˆ¶åˆ†æ (Google Analytics)
  - ç³»çµ±ç›£æ§ (Uptime)

## ç•¶å‰ç‹€æ…‹

### âœ… **Phase 1 å·²å®Œæˆ** (2024-09-25)

#### Backend Infrastructure
- âœ… **Supabaseé …ç›®å‰µå»º** - æ•¸æ“šåº«å¯¦ä¾‹é…ç½®å®Œæˆï¼Œé€£æ¥å¯†é‘°å·²è¨­ç½®
- âœ… **Keystone.jså¾Œç«¯æ­å»º** - å®Œæ•´CMSç³»çµ±ï¼Œé‹è¡Œæ–¼ http://localhost:3001
- âœ… **æ•¸æ“šæ¨¡å‹è¨­è¨ˆ** - User/Report/Payment ä¸‰å¤§æ ¸å¿ƒæ¨¡å‹
  - User: ç”¨æˆ¶è³‡æ–™ã€å…¬å¸ä¿¡æ¯ã€è¨‚é–±ç‹€æ…‹ã€èªè¨€åå¥½
  - Report: ESGè¡¨å–®æ•¸æ“šã€AIç”Ÿæˆå…§å®¹ã€æ”¯ä»˜ç‹€æ…‹ã€æ–‡ä»¶å¼•ç”¨
  - Payment: Airwallexäº¤æ˜“è¿½è¹¤ã€é‡‘é¡ã€ç‹€æ…‹ç®¡ç†

#### Frontend Integration  
- âœ… **Supabaseå®¢æˆ¶ç«¯é›†æˆ** - SDKå®‰è£é…ç½®ï¼Œç’°å¢ƒè®Šé‡è¨­ç½®
- âœ… **èªè­‰ç³»çµ±** - å®Œæ•´ç™»å…¥/è¨»å†Šæµç¨‹ï¼Œæ”¯æŒå‚³çµ±ä¸­æ–‡ç•Œé¢
  - ç™»å…¥é é¢: `/auth/login`
  - è¨»å†Šé é¢: `/auth/register` 
  - ç”¨æˆ¶å„€è¡¨æ¿: `/dashboard` (å—ä¿è­·è·¯ç”±)
- âœ… **TypeScripté¡å‹å®šç¾©** - å®Œæ•´æ•¸æ“šåº«å’ŒAPIéŸ¿æ‡‰é¡å‹
- âœ… **React Context** - å…¨å±€èªè­‰ç‹€æ…‹ç®¡ç†

#### é–‹ç™¼åŸºç¤è¨­æ–½
- âœ… **å‰ç«¯é é¢** - è‘—é™¸é ã€é—œæ–¼é é¢ã€ç”Ÿæˆè¡¨å–®ã€èªè­‰é é¢
- âœ… **å¾Œç«¯CMS** - Keystoneç®¡ç†ç•Œé¢ï¼Œæ•¸æ“šåº«ç®¡ç†
- âœ… **Gitå€‰åº«** - ä»£ç¢¼ç‰ˆæœ¬æ§åˆ¶ï¼Œåœ˜éšŠå”ä½œå°±ç·’

### ğŸš€ **ç•¶å‰å¯ç”¨åŠŸèƒ½**
- ğŸ’» **å‰ç«¯**: https://esgenio.netlify.app âœ… (Next.js + Tailwind - å·²éƒ¨ç½²)
- ğŸ›ï¸ **å¾Œç«¯CMS**: https://esgen-backend.onrender.com âš ï¸ (Keystone.js - éƒ¨åˆ†å®Œæˆ)
- ğŸ” **ç”¨æˆ¶èªè­‰**: è¨»å†Šã€ç™»å…¥ã€å„€è¡¨æ¿ âœ…
- ğŸ“Š **æ•¸æ“šç®¡ç†**: é€šéKeystone CMSç®¡ç†ç”¨æˆ¶å’Œå ±å‘Š âœ…

### ğŸ“‹ **éƒ¨ç½²ç‹€æ…‹æ›´æ–° (2025-09-25)**

#### âœ… **å·²å®Œæˆ**
- [x] **å‰ç«¯éƒ¨ç½² (Netlify)** - esgenio.netlify.app æˆåŠŸé‹è¡Œ
- [x] **TypeScriptéŒ¯èª¤ä¿®å¾©** - æ‰€æœ‰ `any` é¡å‹å’Œæœªä½¿ç”¨è®Šæ•¸å·²ä¿®å¾©
- [x] **Monorepoçµæ§‹** - å¾Œç«¯ä»£ç¢¼å·²æ•´åˆåˆ° `backend/` ç›®éŒ„
- [x] **Renderé…ç½®** - Root Directoryã€Build/Startå‘½ä»¤å·²æ­£ç¢ºè¨­ç½®
- [x] **CORSé…ç½®** - å¾Œç«¯å·²é…ç½®å…è¨±Netlifyå‰ç«¯é€£æ¥
- [x] **ç’°å¢ƒè®Šæ•¸è¨­å®š** - Netlifyå’ŒRenderç’°å¢ƒè®Šæ•¸å·²é…ç½®

#### âš ï¸ **éƒ¨åˆ†å®Œæˆ - éœ€è¦ä¿®å¾©**
- [ ] **å¾Œç«¯æ•¸æ“šåº«é€£æ¥** - Renderç„¡æ³•é€£æ¥åˆ°Supabase
  - **å•é¡Œ**: `Can't reach database server at db.xnzndlekcqqimjocibhk.supabase.co:6543`
  - **å¾…è§£æ±º**: éœ€è¦åœ¨Renderä¸­æ›´æ–° `DATABASE_URL` å¾ `:6543` æ”¹ç‚º `:5432`
  - **ç’°å¢ƒè®Šæ•¸å¾…æ›´æ–°**: `postgres://postgres:It@coda123!@db.xnzndlekcqqimjocibhk.supabase.co:5432/postgres`

#### ğŸ“ **ä¸‹ä¸€æ­¥è¡Œå‹•é …ç›®**
1. **ç«‹å³ä¿®å¾©**: æ›´æ–°Renderä¸­çš„DATABASE_URLä½¿ç”¨ç«¯å£5432
2. **æ¸¬è©¦**: é©—è­‰å¾Œç«¯CMSå¯æ­£å¸¸è¨ªå•
3. **å‰å¾Œç«¯é€£æ¥æ¸¬è©¦**: ç¢ºèªNetlifyå‰ç«¯å¯èª¿ç”¨Renderå¾Œç«¯API

### ğŸ”„ **Phase 2 æº–å‚™å°±ç·’**: AI å ±å‘Šç”Ÿæˆ (éƒ¨ç½²å®Œæˆå¾Œé–‹å§‹)
- â³ **OpenAIé›†æˆ** - å ±å‘Šç”Ÿæˆå¼•æ“é…ç½®
- â³ **PDFç”Ÿæˆç³»çµ±** - å°ˆæ¥­å ±å‘Šæ¨¡æ¿è¨­è¨ˆ
- â³ **é è¦½é é¢é–‹ç™¼** - å…è²»é è¦½/ä»˜è²»å®Œæ•´å ±å‘Š

### â³ **Phase 3 å¾…é–‹å§‹**: æ”¯ä»˜å’Œäº¤ä»˜ (é è¨ˆç¬¬5-6é€±) 
- â³ **Airwallexæ”¯ä»˜é›†æˆ**
- â³ **é›»éƒµç³»çµ±å’ŒPDFäº¤ä»˜**
- â³ **ç”¨æˆ¶å„€è¡¨æ¿å¢å¼·**

## æˆæ¬Š

MIT æˆæ¬Š

---

ç‚ºé¦™æ¸¯ä¼æ¥­å‰µé€ å¯æŒçºŒçš„æœªä¾† ğŸŒ±